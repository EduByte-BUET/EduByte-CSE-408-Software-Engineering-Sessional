<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>EduByte</title>

    <%- include ('../partials/pageheader') %>
        <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>

<body>
    <div id="header" class="header d-flex align-items-center">
        <div class="container-fluid container-xl d-flex align-items-center justify-content-between">
            <%- include ('../partials/navbar') %>
                <!-- navbar partial -->
        </div>
    </div>

    <div class="container">
        <div class="row body-width">
            <div class="col">
                <!--Fetch from database-->
                <h3>
                    <%= data.coursename %>
                </h3>
                <p>
                    <%= data.lecturecount %> Lectures, 16 Quizzes
                </p>
                <div>
                    <ul class="list-group list-group-numbered">
                        <!--here you have to fetch the blocks from database than iterate it over loop for total no of blocks-->

                        <% data.blocklist.forEach(blockinfo=>{ %>

                            <li class="list-group-item d-flex justify-content-between align-items-start">
                                <div class="ms-2 me-auto">
                                    <div class="fw-bold">Block <%= blockinfo.blockno %>
                                    </div>
                                    <button id="myButton" class="dropdown-item" data-value="<%= blockinfo.blockname %>"
                                        value="<%= blockinfo.blockname %>">
                                        <%= blockinfo.blockname %>
                                    </button>
                                </div>
                            </li>

                            <% }); %>
                    </ul>
                </div>
            </div>
            <div class="col pr-2">
                <div class="fixed-header">
                    <h4>
                        <%= data.categoryname %>
                    </h4>
                    <h3>
                        <%= data.coursename %>
                    </h3>
                </div>
                <div class="list-menu">
                    <!--fetch from database-->

                    <!-- Your scrollable content here -->
                    <div class="ms-2 me-auto list-group">
                        <div class="fw-bold"><a href="/block_content">Block|Block Name</a></div>
                        <!--there will be a loop of block wise lectures-->
                        <a id="lectureList" href="/block_content"
                            class="list-group-item list-group-item-action list-group-item-light">
                        </a>
                    </div>

                </div>

            </div>
        </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>

    <script>
        // sample.js
        $(document).ready(function () {
            // Attach a click event handler to the button
            $("#myButton").on("click", function () {
                // Get the custom data attribute value

                // const selectedValue = $("#myButton").val();

                // alert(`Selected Value: ${selectedValue}`);
                event.preventDefault();

                // Get the selected value from the data-value attribute
                const selectedValue = $(this).data("value");

                // Send the data to the backend using AJAX
                $.ajax({
                    type: "POST", // or "GET" depending on your backend route
                    url: "/course_contents",
                    data: { selected_block: selectedValue }, // Send your custom data here
                    success: function (response) {
                        console.log("Backend response:", response);

                        const lecturelist = response.lecturelist;

                        // Update the list section with lecturelist data
                        const lectureListContainer = $("#lectureList");

                        // Clear existing content
                        lectureListContainer.empty();

                        // Append new data to the list
                        lecturelist.forEach(function (lecture) {
                            lectureListContainer.append(`<div>${lecture.TITLE}</div>`);
                        });
                    },
                    error: function (err) {
                        console.error("Error:", err);
                    }
                });
            });
        });

    </script>
</body>

</html>